# 添加新险种指南

## 快速步骤

### 1. 编辑数据源
打开 `scripts/seedData.ts`，添加新产品：

```typescript
export const productsToInsert: SeedProduct[] = [
  // ... 现有产品
  {
    name: '新产品名称',
    content: '完整的产品描述，包含所有关键信息、保额、免赔额、等待期等...',
  }
];
```

### 2. 一键导入
```bash
npx tsx scripts/seed.ts
```

**就这么简单！** 🎉

脚本会自动：
- ✅ 导入产品到数据库
- ✅ AI 生成简短 description  
- ✅ 保留完整 content 作为条款
- ✅ **自动生成向量embeddings**（新功能！）

### 3. 测试搜索
```bash
npm run dev
# 访问 http://localhost:3000
```

---

## 详细说明

### 预期输出
```
共 4 个产品待处理...

[4/4] 处理产品：新产品名称
  检测到原始内容 content...
  AI 提取 description 完成
  使用完整原始内容作为条款（避免信息丢失）
  已创建产品（id=5）
  [1/1] 条款已写入
产品 新产品名称 处理完成。

==== 导入总结报告 ====
产品：创建 1，更新 0，跳过 3，失败 0
条款：插入 1，跳过 0，失败 0

全部成功 ✅

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🔧 检测到新插入条款，开始自动生成向量...

发现 1 条缺失向量的条款

处理条款 #94...
  ✅ 成功（1536维）

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
向量生成完成！
  ✅ 成功: 1 条
  ❌ 失败: 0 条
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

### 如果向量生成失败
脚本会提示你手动运行：
```bash
npx tsx scripts/regenerate-vectors.ts
```

---

## 最佳实践

### Content 内容建议
- 包含完整产品信息（不要简化）
- 包含具体数字（保额、免赔额、比例等）
- 包含关键条款（等待期、除外责任等）
- 使用清晰的分段（可用\n换行）

### 示例
```typescript
{
  name: '乐享年金险',
  content:
    '这是一款长期储蓄型年金保险，适合35-55岁人群规划养老。' +
    '缴费期10年，从第11年开始每年领取基本保额的8%作为年金，保证领取20年。' +
    '若被保险人生存至领取期满，可一次性领取满期金（累计已交保费的120%）。' +
    '特色保障：包含身故保障，身故前未领满20年的，受益人可继续领取至20年；' +
    '支持保单贷款，最高可贷现金价值的80%；' +
    '保费豁免功能，投保人发生全残或身故时，免交剩余保费。' +
    '投保年龄：35-55周岁；保险期间：终身；缴费期：10年。',
}
```

---

## 常见问题

**Q: 已存在的产品会重复导入吗？**  
A: 不会，脚本会自动跳过已存在的产品名称。

**Q: 可以更新现有产品吗？**  
A: 可以，如果 description 有变化会自动更新，但条款不会重复插入。

**Q: 向量生成很慢怎么办？**  
A: 正常，每条约需 100-200ms，脚本已添加限流保护。
