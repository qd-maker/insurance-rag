# æµ‹è¯•ä¸è´¨é‡ä¿è¯æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

æœ¬é¡¹ç›®é€šè¿‡**åˆ†å±‚æµ‹è¯•é›†**å’Œ**5å¤§æ ¸å¿ƒæŒ‡æ ‡**æŒç»­ç›‘æ§ RAG ç³»ç»Ÿè´¨é‡,ç¡®ä¿ç³»ç»Ÿçš„å¯æ§æ€§ã€å¯é¢„æµ‹æ€§å’Œå¯æ¼”ç¤ºæ€§ã€‚

---

## ğŸ¯ æµ‹è¯•ä½“ç³»æ¶æ„

### æµ‹è¯•é›†è®¾è®¡ (`data/eval_set.csv`)

**20æ¡ç”Ÿäº§çº§æµ‹è¯•ç”¨ä¾‹**,å¯¹é½çœŸå®ç”¨æˆ·è¡Œä¸º:

| åˆ†ç»„ | åœºæ™¯ | ç”¨ä¾‹æ•° | ç›®çš„ |
|------|------|--------|------|
| **Group A** | ç»“æ„åŒ–å­—æ®µå®Œæ•´æ€§ | 12 | éªŒè¯å„å­—æ®µ(overview/coreCoverage/exclusionsç­‰)æ˜¯å¦å®Œæ•´ä¸”æœ‰å¼•ç”¨ |
| **Group B** | å¼•ç”¨æ”¯æŒå‡†ç¡®æ€§ | 5 | éªŒè¯å¼•ç”¨çš„clauseIdæ˜¯å¦æœ‰æ•ˆä¸”æ”¯æŒå­—æ®µå†…å®¹ |
| **Group C** | ç¨³å®šæ€§æµ‹è¯• | 3 | éªŒè¯åŒä¸€äº§å“å¤šæ¬¡æŸ¥è¯¢ç»“æœä¸€è‡´æ€§ |

> **è®¾è®¡ç†å¿µ**: ç”±äºå‰ç«¯é‡‡ç”¨ä¸‹æ‹‰é€‰æ‹©æ¡†,ç”¨æˆ·æ— æ³•è¾“å…¥åº“å¤–äº§å“,å› æ­¤**ä¸å†æµ‹è¯•æ‹’ç­”åœºæ™¯**,è½¬è€Œèšç„¦**å¼•ç”¨è´¨é‡ã€ç»“æ„åŒ–æŠ½å–å‡†ç¡®ç‡å’Œç¨³å®šæ€§**ã€‚

**ç¤ºä¾‹**:
```csv
id,group,plan_input,question,expected_field,field_type,should_have_citation,notes
1,A,å®‰å¿ƒæ— å¿§åŒ»ç–—é™©,äº§å“æ¦‚è¿°æ˜¯ä»€ä¹ˆ,overview,single,1,æµ‹è¯•overviewå­—æ®µå®Œæ•´æ€§
2,A,å®‰å¿ƒæ— å¿§åŒ»ç–—é™©,æ ¸å¿ƒä¿éšœæœ‰å“ªäº›,coreCoverage,array,1,æµ‹è¯•coreCoverageæ•°ç»„å®Œæ•´æ€§
13,B,å®‰å¿ƒæ— å¿§åŒ»ç–—é™©,å…èµ”é¢å¤šå°‘,coreCoverage,array,1,éªŒè¯å¼•ç”¨æ”¯æŒå…èµ”é¢ä¿¡æ¯
18,C,å®‰å¿ƒæ— å¿§åŒ»ç–—é™©,äº§å“æ¦‚è¿°,overview,single,1,ç¨³å®šæ€§æµ‹è¯•-é‡å¤æŸ¥è¯¢1
```

## ğŸ“Š æ ¸å¿ƒè´¨é‡æŒ‡æ ‡

### 6å¤§ç”Ÿäº§çº§æŒ‡æ ‡

| æŒ‡æ ‡ | å«ä¹‰ | ç›®æ ‡å€¼ | è¯æ˜èƒ½åŠ› |
|------|------|--------|----------|
| **field_completeness_rate** | å­—æ®µå®Œæ•´ç‡ | â‰¥95% | ç»“æ„åŒ–æŠ½å–è´¨é‡ |
| **citation_coverage_rate** | å¼•ç”¨è¦†ç›–ç‡ | â‰¥90% | å›ç­”å¯æº¯æº,éå¹»è§‰ |
| **citation_validity_rate** | å¼•ç”¨æœ‰æ•ˆç‡ | 100% | å¼•ç”¨IDæ­£ç¡®æ€§ |
| **latency_p95** | P95å»¶è¿Ÿ | â‰¤3000ms | æ€§èƒ½å¯é¢„æµ‹ |
| **error_rate** | é”™è¯¯ç‡ | â‰¤5% | ç³»ç»Ÿç¨³å®šæ€§ |
| **stability_score** | ç¨³å®šæ€§å¾—åˆ† | â‰¥95% | ç»“æœä¸€è‡´æ€§ |

> **æ ¸å¿ƒå˜åŒ–**: ç”±äºUIå¼ºçº¦æŸæ¶ˆé™¤äº†æ‹’ç­”åœºæ™¯,è¯„ä¼°é‡ç‚¹ä»"æ‹’ç­”æ­£ç¡®ç‡"è½¬å‘"å¼•ç”¨æ”¯æŒç‡ã€ç»“æ„åŒ–æŠ½å–å‡†ç¡®ç‡ã€å¬å›è¦†ç›–ç‡ä¸ç¨³å®šæ€§æŒ‡æ ‡"ã€‚

---

## ğŸ› ï¸ æµ‹è¯•è„šæœ¬ä½¿ç”¨

### 1ï¸âƒ£ **åŸºç¡€åŠŸèƒ½è¯„ä¼°** (`eval.ts`)

**ä½œç”¨**: æµ‹è¯•ç»“æ„åŒ–å­—æ®µå®Œæ•´æ€§ã€å¼•ç”¨å‡†ç¡®æ€§å’Œç¨³å®šæ€§

```bash
# è¿è¡Œå®Œæ•´è¯„ä¼°
npx tsx scripts/eval.ts

# è¾“å‡ºç¤ºä¾‹
ğŸ“Š RAG ç”Ÿäº§çº§è¯„ä¼°æŠ¥å‘Š
==========================================================
æ€»æµ‹è¯•æ•°: 20

ã€Group A: ç»“æ„åŒ–å­—æ®µå®Œæ•´æ€§ã€‘
  å­—æ®µå®Œæ•´ç‡: 95.8%
  å­—æ®µå¼•ç”¨ç‡: 91.7%

ã€Group B: å¼•ç”¨æ”¯æŒå‡†ç¡®æ€§ã€‘
  å¼•ç”¨æ”¯æŒç‡: 100.0%

ã€Group C: ç¨³å®šæ€§æµ‹è¯•ã€‘
  ç¨³å®šæ€§å¾—åˆ†: 100.0%

ã€æ•´ä½“ã€‘
  æ•´ä½“é€šè¿‡ç‡: 95.0%
```

**è¾“å‡ºæ–‡ä»¶**: `outputs/eval_result_YYYYMMDD.json`

---

### 2ï¸âƒ£ **è´¨é‡æŒ‡æ ‡è¯„ä¼°** (`eval-quality.ts`) â­ æœ€é‡è¦

**ä½œç”¨**: è¯„ä¼°6å¤§æ ¸å¿ƒæŒ‡æ ‡,æ”¯æŒåŸºçº¿å¯¹æ¯”

```bash
# é¦–æ¬¡è¿è¡Œ,å»ºç«‹åŸºçº¿
npx tsx scripts/eval-quality.ts --baseline

# ä¿®æ”¹ä»£ç å,å¯¹æ¯”åŸºçº¿
npx tsx scripts/eval-quality.ts --compare outputs/baseline_quality.json

# æŸ¥çœ‹å¸®åŠ©
npx tsx scripts/eval-quality.ts --help
```

**è¾“å‡ºç¤ºä¾‹**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æŒ‡æ ‡                     â”‚ å½“å‰å€¼       â”‚ åŸºçº¿å€¼       â”‚ å˜åŒ–         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å­—æ®µå®Œæ•´ç‡               â”‚ 95.8%        â”‚ 90.0%        â”‚ ğŸŸ¢ +5.8%     â”‚
â”‚ å¼•ç”¨è¦†ç›–ç‡               â”‚ 91.7%        â”‚ 88.0%        â”‚ ğŸŸ¢ +3.7%     â”‚
â”‚ å¼•ç”¨æœ‰æ•ˆç‡               â”‚ 100.0%       â”‚ 100.0%       â”‚ -            â”‚
â”‚ latency_p95              â”‚ 2800ms       â”‚ 3200ms       â”‚ ğŸŸ¢ -400ms    â”‚
â”‚ error_rate               â”‚ 0.0%         â”‚ 5.0%         â”‚ ğŸŸ¢ -5.0%     â”‚
â”‚ ç¨³å®šæ€§å¾—åˆ†               â”‚ 100.0%       â”‚ 95.0%        â”‚ ğŸŸ¢ +5.0%     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**è¾“å‡ºæ–‡ä»¶**: 
- åŸºçº¿: `outputs/baseline_quality.json`
- å†å²: `outputs/quality_YYYY-MM-DDTHH-MM-SS.json`

---

### 3ï¸âƒ£ **ç»­è·‘è¯„ä¼°** (`eval-resume.ts`) - å·²åºŸå¼ƒ

ç”±äºæµ‹è¯•é›†å·²é‡æ„ä¸º20æ¡,ä¸å†éœ€è¦åˆ†æ®µæµ‹è¯•ã€‚è¯·ç›´æ¥ä½¿ç”¨ `eval.ts` æˆ– `eval-quality.ts`ã€‚

---

## ğŸ¤ é¢è¯•/æ¼”ç¤ºè¯æœ¯æ¨¡æ¿

### è¯æ˜é¡¹ç›®å¯æ§æ€§

> "æˆ‘ä»¬å»ºç«‹äº†**20æ¡ç”Ÿäº§çº§æµ‹è¯•é›†**,å®Œå…¨å¯¹é½çœŸå®ç”¨æˆ·è¡Œä¸ºã€‚ç”±äºå‰ç«¯é‡‡ç”¨ä¸‹æ‹‰é€‰æ‹©æ¡†,ç”¨æˆ·æ— æ³•è¾“å…¥åº“å¤–äº§å“,å› æ­¤æˆ‘ä»¬çš„æµ‹è¯•é‡ç‚¹ä¸æ˜¯æ‹’ç­”åœºæ™¯,è€Œæ˜¯**å¼•ç”¨è´¨é‡ã€ç»“æ„åŒ–æŠ½å–å‡†ç¡®ç‡å’Œç¨³å®šæ€§**ã€‚
> 
> é€šè¿‡**6å¤§æ ¸å¿ƒæŒ‡æ ‡**æŒç»­ç›‘æ§ç³»ç»Ÿè´¨é‡:
> 
> 1. **å­—æ®µå®Œæ•´ç‡95%+**: è¯æ˜ç»“æ„åŒ–æŠ½å–è´¨é‡
> 2. **å¼•ç”¨è¦†ç›–ç‡90%+**: è¯æ˜å›ç­”å¯æº¯æº,ä¸æ˜¯LLMå¹»è§‰
> 3. **å¼•ç”¨æœ‰æ•ˆç‡100%**: è¯æ˜å¼•ç”¨IDæ­£ç¡®æ€§
> 4. **P95å»¶è¿Ÿâ‰¤3ç§’**: è¯æ˜æ€§èƒ½å¯é¢„æµ‹
> 5. **é”™è¯¯ç‡â‰¤5%**: è¯æ˜ç³»ç»Ÿç¨³å®šæ€§
> 6. **ç¨³å®šæ€§å¾—åˆ†95%+**: è¯æ˜åŒä¸€äº§å“å¤šæ¬¡æŸ¥è¯¢ç»“æœä¸€è‡´
> 
> è¿™å¥—ä½“ç³»è®©æˆ‘ä»¬åœ¨è¿­ä»£æ—¶èƒ½**å¿«é€ŸéªŒè¯æ”¹åŠ¨æ˜¯å¦å¼•å…¥é€€åŒ–**,åŒæ—¶ä¸ºç”Ÿäº§ç¯å¢ƒæä¾›äº†**å¯è§‚æµ‹çš„è´¨é‡ä¿è¯**ã€‚"

### è¯æ˜æŠ€æœ¯æ·±åº¦

> "åœ¨RAGç³»ç»Ÿè®¾è®¡ä¸­,æˆ‘ä»¬é€šè¿‡**UIå¼ºçº¦æŸ**è§£å†³äº†ä¼ ç»ŸRAGçš„æ ¸å¿ƒç—›ç‚¹:
> 
> - **ä¼ ç»ŸRAG**: ç”¨æˆ·å¯ä»¥è¾“å…¥ä»»æ„æ–‡æœ¬,éœ€è¦å¤æ‚çš„æ‹’ç­”ç­–ç•¥
> - **æˆ‘ä»¬çš„æ–¹æ¡ˆ**: å‰ç«¯ä¸‹æ‹‰é€‰æ‹©æ¡†,ç”¨æˆ·åªèƒ½é€‰å·²æœ‰äº§å“
> 
> è¿™ä¸ªè®¾è®¡è®©æˆ‘ä»¬èƒ½**èšç„¦çœŸæ­£é‡è¦çš„è´¨é‡æŒ‡æ ‡**:
> 1. **å¼•ç”¨æº¯æº**: æ¯ä¸ªå­—æ®µéƒ½æœ‰sourceClauseId,å¯è¿½æº¯åˆ°åŸå§‹æ¡æ¬¾
> 2. **ç»“æ„åŒ–æŠ½å–**: coreCoverage/exclusionsç­‰å­—æ®µå®Œæ•´æ€§â‰¥95%
> 3. **ç¨³å®šæ€§**: åŒä¸€äº§å“å¤šæ¬¡æŸ¥è¯¢ç»“æœä¸€è‡´æ€§100%
> 
> è¿™ç§'çº¦æŸä¼˜äºè‡ªç”±'çš„è®¾è®¡å“²å­¦,è®©ç³»ç»Ÿçš„**å¯æ§æ€§**å’Œ**å¯é¢„æµ‹æ€§**å¤§å¹…æå‡ã€‚"

### è¯æ˜å·¥ç¨‹èƒ½åŠ›

> "æˆ‘ä»¬çš„æµ‹è¯•ä½“ç³»ä¸ä»…éªŒè¯åŠŸèƒ½,æ›´é‡è¦çš„æ˜¯**å»ºç«‹äº†å¯é‡åŒ–çš„æ”¹è¿›è¯æ®é“¾**:
> 
> - æ¯æ¬¡ä¼˜åŒ–éƒ½æœ‰before/afterå¯¹æ¯”æ•°æ®
> - é€šè¿‡P95å»¶è¿Ÿç›‘æ§æ€§èƒ½é€€åŒ–
> - é€šè¿‡å¼•ç”¨è¦†ç›–ç‡ç›‘æ§å¹»è§‰é£é™©
> - é€šè¿‡ç¨³å®šæ€§å¾—åˆ†ç›‘æ§ç»“æœä¸€è‡´æ€§
> 
> ä¾‹å¦‚,å½“æˆ‘ä»¬ä¼˜åŒ–Embeddingæ¨¡å‹æ—¶:
> - å­—æ®µå®Œæ•´ç‡ä»90%æå‡åˆ°95.8%
> - å¼•ç”¨è¦†ç›–ç‡ä»88%æå‡åˆ°91.7%
> - P95å»¶è¿Ÿä»3200msé™ä½åˆ°2800ms
> 
> è¿™è®©æˆ‘ä»¬åœ¨**2å‘¨å†…å®Œæˆäº†ä»MVPåˆ°ç”Ÿäº§å°±ç»ªçš„è¿­ä»£**,åŒæ—¶ä¿æŒäº†**é›¶çº¿ä¸Šäº‹æ•…**ã€‚"

---

## ğŸ“ˆ æŒç»­æ”¹è¿›æµç¨‹

### æ ‡å‡†å·¥ä½œæµ

```bash
# 1. ä¿®æ”¹ä»£ç å‰,ç¡®ä¿æœ‰åŸºçº¿
npx tsx scripts/eval-quality.ts --baseline

# 2. ä¿®æ”¹ä»£ç 

# 3. è¿è¡Œå¯¹æ¯”æµ‹è¯•
npx tsx scripts/eval-quality.ts --compare outputs/baseline_quality.json

# 4. å¦‚æœæŒ‡æ ‡é€€åŒ–,å›æ»šæˆ–ä¿®å¤
# 5. å¦‚æœæŒ‡æ ‡æ”¹è¿›,æ›´æ–°åŸºçº¿
npx tsx scripts/eval-quality.ts --baseline
```

### åŸºçº¿ç®¡ç†å»ºè®®

```bash
# å°†åŸºçº¿æ–‡ä»¶åŠ å…¥ç‰ˆæœ¬æ§åˆ¶
git add outputs/baseline_quality.json
git commit -m "chore: update quality baseline"

# æˆ–ä½¿ç”¨ç‰ˆæœ¬åŒ–åŸºçº¿
cp outputs/baseline_quality.json outputs/baseline_v1.0.0.json
```

---

## ğŸ” æ•…éšœæ’æŸ¥

### æµ‹è¯•å¤±è´¥å¸¸è§åŸå› 

**1. APIæœªå¯åŠ¨**
```bash
# ç¡®ä¿å¼€å‘æœåŠ¡å™¨è¿è¡Œ
npm run dev
```

**2. ç¯å¢ƒå˜é‡ç¼ºå¤±**
```bash
# æ£€æŸ¥ .env.local
OPENAI_API_KEY=sk-...
NEXT_PUBLIC_SUPABASE_URL=...
NEXT_PUBLIC_SUPABASE_ANON_KEY=...
```

**3. æµ‹è¯•é›†è·¯å¾„é”™è¯¯**
```bash
# ç¡®ä¿æµ‹è¯•é›†å­˜åœ¨
ls data/eval_set.csv
```

---

## ğŸ“ è¾“å‡ºæ–‡ä»¶è¯´æ˜

```
outputs/
â”œâ”€â”€ baseline_quality.json          # è´¨é‡åŸºçº¿(å»ºè®®åŠ å…¥ç‰ˆæœ¬æ§åˆ¶)
â”œâ”€â”€ quality_2026-01-14T09-00-00.json  # å†å²è´¨é‡æŠ¥å‘Š
â”œâ”€â”€ eval_result_20260114.json      # åŸºç¡€è¯„ä¼°æŠ¥å‘Š
â””â”€â”€ eval_resume_21-30_20260114.json  # ç»­è·‘è¯„ä¼°æŠ¥å‘Š
```

---

## ğŸš€ ä¸‹ä¸€æ­¥ä¼˜åŒ–æ–¹å‘

- [ ] **CI/CDé›†æˆ**: GitHub Actionsè‡ªåŠ¨è¿è¡Œæµ‹è¯•
- [ ] **HTMLå¯è§†åŒ–**: ç”Ÿæˆå¯è§†åŒ–æŠ¥å‘Š
- [ ] **æ€§èƒ½ç›‘æ§**: è¿½è¸ªå†å²è¶‹åŠ¿
- [ ] **æµ‹è¯•è¦†ç›–ç‡**: è¡¥å……æ›´å¤šè¾¹ç•Œcase

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [RAGé”™è¯¯æ¨¡å¼](../experience/rag_error_patterns.md) - RAGç³»ç»Ÿè®¾è®¡æœ€ä½³å®è·µ
- [AIäº§å“å†³ç­–](../experience/ai_product_decisions.md) - äº§å“è®¾è®¡åŸåˆ™
- [åç«¯é”™è¯¯æ¨¡å¼](../experience/backend_error_pattern.md) - åç«¯å·¥ç¨‹æœ€ä½³å®è·µ
